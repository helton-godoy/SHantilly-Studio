# Specification: Studio Persistence & Code Generation

## 1. Overview

Esta trilha visa transformar o Showbox Studio de um editor volátil em uma ferramenta de produção capaz de salvar o trabalho do usuário e gerar artefatos executáveis (scripts shell).

## 2. Code Generation (Export to Shell)

O Studio deve ser capaz de gerar um script shell compatível com a CLI do Showbox.

### 2.1. The `ScriptGenerator` Class

Uma classe responsável por percorrer a hierarquia de widgets do Studio e produzir strings formatadas.

**Logic:**

1.  **Header:** Shebang e setup inicial.
2.  **Window Config:** Gerar comando `add window ...`.
3.  **Widget Traversal:** Recursivamente percorrer filhos.
    - Para cada widget: `add <type> name=<name> ...`
    - Para cada propriedade modificada: `set <name> <prop>=<value>` (ou incluir no `add` se suportado).
    - Para containers: O Showbox CLI usa estrutura plana ou aninhada? A V1 nova suporta contexto. O gerador deve respeitar a ordem de criação.

**Example Output:**

```bash
#!/bin/bash
# Generated by Showbox Studio

showbox << EOD
add window title="My App" width=800 height=600

add label name=lbl_1 text="Hello World"
add button name=btn_1 text="Click Me"

# Layouts (Implicit in V1 via add order/context, but Studio might need explicit layout commands if using containers)
EOD
```

## 3. Project Persistence (Save/Load)

Para permitir edição futura, precisamos salvar o estado do Studio, incluindo metadados que não vão para o script final (ex: posição no canvas de design, anotações, etc - embora na V1 seja tudo via layout, no designer livre as posições importam se não houver layout).

**Format:** JSON (`.sbxproj`)
**Structure:**

```json
{
  "version": "1.0",
  "meta": {
    "author": "User",
    "created": "2026-01-17"
  },
  "root": {
    "type": "window",
    "props": { "title": "My App", ... },
    "children": [
      {
        "type": "label",
        "name": "lbl_1",
        "props": { "text": "Hello" }
      }
    ]
  }
}
```

## 4. Live Preview

Capacidade de executar o script gerado imediatamente.

- Salvar script em `/tmp/preview.sbx`.
- Executar `../showbox/build/bin/poc_modern_cli < /tmp/preview.sbx` (ou o executável correto).
- Capturar output para console de debug no Studio.
